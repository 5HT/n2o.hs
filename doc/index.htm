<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Network.N2O</title>
    <meta name="description" content="Haskell N2O Protocol" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link href="http://fonts.googleapis.com/css?family=Lovers%20Quarrel%7CSource%20Sans%20Pro%3A400%2C600%2C400italic%7CBitter%3A400%2C400italic" rel="stylesheet" type="text/css" />
    <link href="css/n2o.hs.css" media="screen" rel="stylesheet" />

  </head>
  <body class="2ng-cloak">
    <div id="footer-fix-container">
      <div id="header">
        <div class="container">
          <div class="row">
            <div class="span4">
              <h1>
                <a href="#">n2o.hs</a>

              </h1>
            </div>
            <div id="nav" class="span8">
              <a  href="#">Protocol</a><span class="hidden">
              </span><a  href="#">Messages</a><span class="hidden"></span>
            </div>
          </div>
        </div>
      </div>

        <div class="page-separator"> </div>

      <div class="container" id="content">
        <div class="row">
          <div class="span6 offset3">


<div class="article">

  <h2><a href="#">N2O Protocol</a></h2>

    <div class="p muted">
      <i class="fa fa-fw fa-calendar"></i> Feb 19, 2015. Losar
    </div>

  <div class="p">Maxim Sokhatsky <a href="#">maxim@synrc.com</a>.</div>

<h3>TOC</h3>

<a href="#">Client Events</a>
<ul><li>HEART</li>
    <li>CLIENT</li>
    <li>BIN</li>
    <li>DIRECT</li>
    <li>PICKLE</li>
    <li>EV</li>
</ul>
<a href="#">Server Events</a>
<ul><li>IO</li>
    <li>SERVER</li>
    <li>BINARY</li>
    <li>[]</li>
</ul>
<a href="#">Server Structures</a>
<ul><li>CX</li>
    <li>HANDLER</li>
    <li>ELEMENT</li>
    <li>ACTION</li>
</ul>

<h3>Client Events</h3>

<h4>HEART Events</h4>

<p>Hardtbeat events are only text events</p>

<pre>
    "N2O,"           -- init SPA session
    "N2O,0.5676.1"   -- transfer session from HTTP process
    "PING"           -- application ping
</pre>

<h4>SPA Events</h4>

<div class="p">
SPA events should be using when building single page application
which works by defined protocol. Such protocols could be instant
messaging protocols like <code>synrc/smp</code>
or <code>synrc/games</code> protocols. Any particular web
application has its own protocol.
</div>

JavaScript:
<pre>
enc(tuple(atom('client'),"123"));
</pre>

Haskell:
<pre>
TupleTerm [AtomTerm "client", Term body]
</pre>

Erlang:
<pre>
{client,_}
</pre>

<h4>PICKLE Events</h2>

This kind of events are RPC message calls to <code>module</code> and <code>function</code>.
PICKLE events are being sent pickled by server side picklers.
N2O supports following picklers:

<ul><li>PLAIN binary BERT encoding of the event or</li>
<li>AES/CBC encrypted event for sensitive information about the API.</li></ul>

JavaScript:
<pre>
JS> enc(tuple(atom('pickle'),
              atom('deposits'),
              tuple(atom('ev'),
                    atom('deposits'),
                    tuple(atom('error'),'6189'),
                    atom('#next'),
                    atom('event')),
              [tuple(atom('user'),'maxim'),
               tuple(atom('pass'),'token')]);
</pre>

Erlang:
<pre>
{pickle,_,_,_}

      ERL> {pickle,deposits,
                   {ev,deposits,
                       {error,"6189"},
                       '#next',
                       event},
                   [{user,<<"maxim">>},
                    {pass,<<"token">>}].
</pre>

<h4>EV Pickled Events</h2>

Haskell:
<pre>
TupleTerm [AtomTerm "ev", AtomTerm to, Term body,
                          AtomTerm from, AtomTerm type]
</pre>

Erlang:
<pre>
{ev,_,_,_,_}
</pre>

<h3>Server Events</h3>

<h4>IO Events</h2>

<p>IO events are containers for data and codata. Third element
of a tuple will be directly evaluated in WebBrowser.
IO events are normally not constructed on client.</p>

Haskell:
<pre>
TupleTerm [AtomTerm "io", BinaryTerm data, BinaryTerm eval]
</pre>

Erlang:
<pre>
{io,_,_}
</pre>

<h3>Server Structues</h3>

<h4>CX Context</h2>

<h4>HANDLER Context</h2>

<h4>ELEMENT Element</h2>

<h4>ACTION Action</h2>

    <div class="row p">
        <div class="span6 next-post offset6">
          <a href="#">Top</a>
        </div>
    </div>

</div>

<!--div class="article">

<h2><a href="#">Custom Protocols</a></h2>

<h3>Roster Application</h3>

<h4>JOIN</h2>

<h4>SEND</h2>

<h4>MESSAGE</h2>

<h3>XA Protocol</h3>

<h4>PREPARE</h2>

<h4>COMMIT</h2>

<h4>ROLLBACK</h2>

    <div class="row p">
        <div class="span6 next-post offset6">
          <a href="#">Joy</a>
        </div>
    </div>

</div-->


          </div>
        </div>
      </div>

      <div id="footer-container">
        <div class="page-separator"> </div>
        <div class="container" id="footer">
          <div class="p">&copy; 2015 Synrc Research Center.  All rights reserved.</div>
        </div>
      </div>
    </div>

  </body>
</html>


